---
layout: post
title:  从Linux向Windows拷贝git仓库后的无法消除的"old mode/new mode"问题
date:   2016-11-19 20:53:30 +0800
tags: [折腾,Linux,Git,打倒方校长]
---

由于众所周知的原因，国内访问github的速度相当恶心。即使为git挂上代理，由于git是单线程工作，要搞一些大仓库所需的时间还是相当感人。

如果你有一台位于国外的VPS，一个办法是在此VPS上装git，然后从github克隆到VPS，再将克隆后的git仓库整个打包，随后通过多线程工具传输到本地。别看折腾这么多，对于稍大点的仓库，此方法还是可以节约大量时间。

然后，这样拷贝来的仓库并非git所推荐的方法。下载到本地解压之后，因为换行符问题，git会报告很多文件被修改过，此时可以通过下列命令丢弃所有更改：

```
git reset --hard
```

执行之后，所有文件恢复刚刚`checkout`出来的状态。由于这时是在windows上执行命令，出来的文件都是windows换行符，就不会报修改了。

然而，今天这一招碰上了问题，执行完`git reset --hard`之后，还是有几十个文件显示被修改过——但是也不显示怎么修改的，`git diff`只能看到：

```
old mode 100755
new mode 100644
```

看到755和644，敏感的同志就应该注意到了，这是文件权限的问题。windows文件系统下显然提供不了相应的linux权限，此问题解决办法是让git不要瞎插手权限的事情：

```
git config core.filemode false
```

天下太平！